{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:30:49"}
{"isJoi":true,"name":"ValidationError","details":[{"message":"\"start_at\" must be larger than or equal to \"Thu Aug 05 2021 13:25:48 GMT+0700 (Indochina Time)\"","path":["start_at"],"type":"date.min","context":{"limit":"2021-08-05T06:25:48.933Z","value":"2021-08-04T01:35:08.674Z","key":"start_at","label":"start_at"}}],"_object":{"product_scope":"partial","products":[{"product_id":"5e74949c6bd99e6a93fb2603","model_scope":"partial","models":[{"model_images":["asdddddddddddddddddd"],"model_id":"60a7f38411d36824a1b6821d","unlimited":false,"total":10000,"remain":10}]}],"store_id":"5e74812c6bd99e6a93faf8dd","name":"Thích thì KM","description":"Ngon, bổ, rẻ","type":"percent","value":"0.5","refund":"0.2","start_at":"2021-08-04T01:35:08.674Z","expire_at":"2021-08-31T08:39:08.674Z","conditions":[{"type":"min-quantity","value":1}]},"level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:33:18","message":"child \"start_at\" fails because [\"start_at\" must be larger than or equal to \"Thu Aug 05 2021 13:25:48 GMT+0700 (Indochina Time)\"]","stack":"ValidationError: child \"start_at\" fails because [\"start_at\" must be larger than or equal to \"Thu Aug 05 2021 13:25:48 GMT+0700 (Indochina Time)\"]\n    at Object.exports.process (/home/minhkha/Desktop/store/stht-server/node_modules/@hapi/joi/lib/errors.js:202:19)\n    at internals.Object._validateWithOptions (/home/minhkha/Desktop/store/stht-server/node_modules/@hapi/joi/lib/types/any/index.js:763:31)\n    at module.exports.internals.Any.validate (/home/minhkha/Desktop/store/stht-server/node_modules/@hapi/joi/lib/index.js:145:23)\n    at /home/minhkha/Desktop/store/stht-server/src/commons/middlewares/joi.validate.js:12:30\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:112:3)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:281:22\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at Function.handle (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:174:3)\n    at router (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:317:13)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:284:7\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at _callee7$ (/home/minhkha/Desktop/store/stht-server/src/commons/middlewares/auth.js:318:16)\n    at tryCatch (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:63:40)\n    at Generator.invoke [as _invoke] (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:294:22)\n    at Generator.next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:119:21)\n    at asyncGeneratorStep (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)\n    at _next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:25:9)\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)"}
{"statusCode":400,"error":4000,"message":{"start_at":"\"start_at\" must be larger than or equal to \"Thu Aug 05 2021 13:25:48 GMT+0700 (Indochina Time)\""},"errors":{"start_at":4000701},"user_id":"5e747e4f6bd99e6a93faec25","company_id":"5e747f036bd99e6a93faef55","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:33:18","stack":"Error: [object Object]\n    at Object.getJoiError (/home/minhkha/Desktop/store/stht-server/src/commons/over_function/over.js:5:16)\n    at /home/minhkha/Desktop/store/stht-server/src/commons/middlewares/joi.validate.js:17:22\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:112:3)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:281:22\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at Function.handle (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:174:3)\n    at router (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:317:13)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:284:7\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at _callee7$ (/home/minhkha/Desktop/store/stht-server/src/commons/middlewares/auth.js:318:16)\n    at tryCatch (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:63:40)\n    at Generator.invoke [as _invoke] (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:294:22)\n    at Generator.next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:119:21)\n    at asyncGeneratorStep (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)\n    at _next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:25:9)\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)"}
{"statusCode":400,"error":7000,"message":"product already existed in other promotion","errors":{"promotion":7001622},"already_promotion":[{"product_ids":["5e74949c6bd99e6a93fb2603"],"status":"active","_id":"610b88321a2052150bae1507","products":[{"model_list":[{"tier_index":[0],"status":"active","is_limited_stock":true,"batch_box_stock":0,"os_box_stock":0,"box_stock":0,"stock_per_box":1,"stock":0,"on_sales_stock":0,"images":[],"sold_count":59,"refund_rate":0.1,"discount":0,"discount_rate":0,"promotion_refund_rate":0,"promotion_discount_rate":0,"global_promotion_refund_rate":0,"global_promotion_discount_rate":0,"_id":"60a7f38411d36824a1b6821d","model_id":"60a7f38411d36824a1b6821d","name":"default","price":699000,"refund":69900,"total_refund_rate":0.1,"pure_name":"default"},{"tier_index":[0],"status":"active","is_limited_stock":true,"batch_box_stock":0,"os_box_stock":0,"box_stock":0,"stock_per_box":1,"stock":0,"on_sales_stock":0,"images":[],"sold_count":59,"refund_rate":0.1,"discount":0,"discount_rate":0,"promotion_refund_rate":0,"promotion_discount_rate":0,"global_promotion_refund_rate":0,"global_promotion_discount_rate":0,"_id":"60a7f38411d36824a1b6821e","model_id":"60a7f38411d36824a1b6821e","name":"model 1","price":699000,"refund":69900,"total_refund_rate":0.1,"pure_name":"model 1"}],"model_ids":["60a7f38411d36824a1b6821d"],"_id":"5e74949c6bd99e6a93fb2603","product_id":"5e74949c6bd99e6a93fb2603","model_scope":"partial","models":[{"model_images":[],"_id":"610b88321a2052150bae1509","model_id":"60a7f38411d36824a1b6821d","unlimited":false,"total":10000,"remain":10}],"id":"5e74949c6bd99e6a93fb2603","is_remain":true}],"store_id":"5e74812c6bd99e6a93faf8dd","name":"Thích thì KM","start_at":"2021-08-05T13:52:08.674Z","expire_at":"2021-08-31T08:39:08.674Z","company_id":"5e747f036bd99e6a93faef55","_max_value":0,"converter_status":"pending","id":"610b88321a2052150bae1507"}],"duplicate_product":{"0":{"errors":{"product_id":7001622},"message":"product already existed in other one","promotion_id":"610b88321a2052150bae1507","promotion_name":"Thích thì KM","start_at":"2021-08-05T13:52:08.674Z","expire_at":"2021-08-31T08:39:08.674Z","product_id":"5e74949c6bd99e6a93fb2603","model_id":"60a7f38411d36824a1b6821d"}},"user_id":"5e747e4f6bd99e6a93faec25","company_id":"5e747f036bd99e6a93faef55","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:43:43","stack":"Error: product already existed in other promotion\n    at _callee2$ (/home/minhkha/Desktop/store/stht-server/src/search/promotion/v2/promotion.handler.js:174:13)\n    at tryCatch (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:63:40)\n    at Generator.invoke [as _invoke] (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:294:22)\n    at Generator.next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:119:21)\n    at asyncGeneratorStep (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)\n    at _next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:25:9)\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:54:39"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:55:09"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 13:56:48"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 14:01:39"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 14:02:14"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 14:03:24"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 14:03:52"}
{"isJoi":true,"name":"ValidationError","details":[{"message":"\"store_id\" is required","path":["store_id"],"type":"any.required","context":{"key":"store_id","label":"store_id"}}],"_object":{"product_scope":"partial","products":[{"product_id":"5e74949c6bd99e6a93fb2603","model_scope":"partial","models":[{"model_images":["asdddddddddddddddddd"],"model_id":"60a7f38411d36824a1b6821d","unlimited":false,"total":10000,"remain":10}]}],"name":"Thích thì KM","description":"Ngon, bổ, rẻ","type":"percent","value":"0.5","refund":"0.2","start_at":"2021-08-05T11:00:08.674Z","expire_at":"2021-08-31T08:39:08.674Z","conditions":[{"type":"min-quantity","value":1}]},"level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 14:11:21","message":"child \"store_id\" fails because [\"store_id\" is required]","stack":"ValidationError: child \"store_id\" fails because [\"store_id\" is required]\n    at Object.exports.process (/home/minhkha/Desktop/store/stht-server/node_modules/@hapi/joi/lib/errors.js:202:19)\n    at internals.Object._validateWithOptions (/home/minhkha/Desktop/store/stht-server/node_modules/@hapi/joi/lib/types/any/index.js:763:31)\n    at module.exports.internals.Any.validate (/home/minhkha/Desktop/store/stht-server/node_modules/@hapi/joi/lib/index.js:145:23)\n    at /home/minhkha/Desktop/store/stht-server/src/commons/middlewares/joi.validate.js:12:30\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:112:3)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:281:22\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at Function.handle (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:174:3)\n    at router (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:317:13)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:284:7\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at _callee7$ (/home/minhkha/Desktop/store/stht-server/src/commons/middlewares/auth.js:318:16)\n    at tryCatch (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:63:40)\n    at Generator.invoke [as _invoke] (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:294:22)\n    at Generator.next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:119:21)\n    at asyncGeneratorStep (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)\n    at _next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:25:9)\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)"}
{"statusCode":400,"error":4000,"message":{"store_id":"\"store_id\" is required"},"errors":{"store_id":4000100},"user_id":"5e747e4f6bd99e6a93faec25","company_id":"5e747f036bd99e6a93faef55","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 14:11:21","stack":"Error: [object Object]\n    at Object.getJoiError (/home/minhkha/Desktop/store/stht-server/src/commons/over_function/over.js:5:16)\n    at /home/minhkha/Desktop/store/stht-server/src/commons/middlewares/joi.validate.js:17:22\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/route.js:112:3)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:281:22\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at Function.handle (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:174:3)\n    at router (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:317:13)\n    at /home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:284:7\n    at Function.process_params (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:335:12)\n    at next (/home/minhkha/Desktop/store/stht-server/node_modules/express/lib/router/index.js:275:10)\n    at _callee7$ (/home/minhkha/Desktop/store/stht-server/src/commons/middlewares/auth.js:318:16)\n    at tryCatch (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:63:40)\n    at Generator.invoke [as _invoke] (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:294:22)\n    at Generator.next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/node_modules/regenerator-runtime/runtime.js:119:21)\n    at asyncGeneratorStep (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:3:24)\n    at _next (/home/minhkha/Desktop/store/stht-server/node_modules/@babel/runtime/helpers/asyncToGenerator.js:25:9)\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 15:19:05"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 15:19:27"}
{"message":"elasticsearch cluster is down!","level":"error","service":"sumviet-apidevelopment","timestamp":"2021-08-05 15:30:46"}
